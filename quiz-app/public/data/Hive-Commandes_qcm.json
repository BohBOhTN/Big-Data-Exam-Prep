{
  "topic_name": "Hive Commandes",
  "topic_description": "Questions avec Corrections et Conseils",
  "author": "Mohamed KOUBAA",
  "num_questions": 40,
  "questions": [
    {
      "question_number": 1,
      "question_text": "Quelle commande permet de cr√©er une base de donn√©es si elle n'existe pas d√©j√† ?",
      "options": [
        {
          "letter": "A",
          "text": "CREATE DATABASE database_name",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "CREATE DATABASE IF NOT EXISTS database_name",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "NEW DATABASE database_name",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "MAKE DATABASE database_name",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`IF NOT EXISTS` √©vite les erreurs si la base existe d√©j√†. Bonne pratique dans les scripts pour l'idempotence."
    },
    {
      "question_number": 2,
      "question_text": "Quelle commande affiche la liste de toutes les bases de donn√©es ?",
      "options": [
        {
          "letter": "A",
          "text": "LIST DATABASES",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "DISPLAY DATABASES",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "SHOW DATABASES",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "VIEW DATABASES",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`SHOW DATABASES` (ou `SHOW SCHEMAS`). Commandes similaires : `SHOW TABLES`, `SHOW PARTITIONS`, `SHOW FUNCTIONS`."
    },
    {
      "question_number": 3,
      "question_text": "Quelle commande permet de s√©lectionner une base de donn√©es pour l'utiliser ?",
      "options": [
        {
          "letter": "A",
          "text": "SELECT database_name",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "OPEN database_name",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "USE database_name",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "SWITCH database_name",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`USE db_name` change le contexte de la session. Apr√®s cela, les tables sont r√©f√©renc√©es sans pr√©fixe (table au lieu de db.table)."
    },
    {
      "question_number": 4,
      "question_text": "Par d√©faut, peut-on supprimer une base de donn√©es contenant des tables ?",
      "options": [
        {
          "letter": "A",
          "text": "Oui, sans probl√®me",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Non, il faut utiliser CASCADE",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Oui, mais avec un avertissement",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Non, il faut d'abord la renommer",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`DROP DATABASE db_name` √©choue si elle contient des tables. Utilisez `DROP DATABASE db_name CASCADE` pour tout supprimer."
    },
    {
      "question_number": 5,
      "question_text": "Quel est le suffixe ajout√© au nom de la base de donn√©es dans HDFS ?",
      "options": [
        {
          "letter": "A",
          "text": ".database",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": ".db",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": ".hive",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Aucun suffixe",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Structure HDFS : `/user/hive/warehouse/mabase.db/matable/`. Le suffixe .db identifie les r√©pertoires de bases de donn√©es."
    },
    {
      "question_number": 6,
      "question_text": "O√π se trouve le r√©pertoire d'une table dans HDFS par rapport √† sa base de donn√©es ?",
      "options": [
        {
          "letter": "A",
          "text": "Au m√™me niveau",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Dans un sous-r√©pertoire de la base de donn√©es",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Dans un r√©pertoire parent",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "√Ä la racine de HDFS",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Hi√©rarchie : warehouse/ ‚Üí database.db/ ‚Üí table/ ‚Üí [partition/] ‚Üí fichiers. La table est un sous-r√©pertoire de la BD."
    },
    {
      "question_number": 7,
      "question_text": "Quel mot-cl√© permet de cr√©er une table visible uniquement dans la session courante ?",
      "options": [
        {
          "letter": "A",
          "text": "SESSION",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "LOCAL",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "TEMPORARY",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "PRIVATE",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`CREATE TEMPORARY TABLE ...` cr√©e une table √©ph√©m√®re. Utile pour les transformations interm√©diaires (ex: conversion texte‚Üíparquet)."
    },
    {
      "question_number": 8,
      "question_text": "Le mot-cl√© EXTERNAL dans CREATE TABLE signifie que :",
      "options": [
        {
          "letter": "A",
          "text": "La table est stock√©e sur un serveur externe",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Hive ne g√®re pas physiquement les donn√©es",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "La table est crypt√©e",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "La table est en lecture seule",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Table EXTERNE : DROP supprime les m√©tadonn√©es mais conserve les fichiers. Id√©al quand les donn√©es sont partag√©es avec d'autres syst√®mes."
    },
    {
      "question_number": 9,
      "question_text": "Quelle clause permet de sp√©cifier un chemin HDFS personnalis√© pour une table externe ?",
      "options": [
        {
          "letter": "A",
          "text": "PATH",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "DIRECTORY",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "LOCATION",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "HDFS_PATH",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`CREATE EXTERNAL TABLE ... LOCATION '/custom/path/'`. Sans LOCATION, m√™me les tables externes vont dans warehouse."
    },
    {
      "question_number": 10,
      "question_text": "Quel est le format de stockage par d√©faut si non sp√©cifi√© ?",
      "options": [
        {
          "letter": "A",
          "text": "PARQUET",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "ORC",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "TEXTFILE",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "AVRO",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "TEXTFILE = d√©faut (lisible, peu performant). Sp√©cifiez toujours `STORED AS PARQUET` ou `ORC` en production pour de meilleures performances."
    },
    {
      "question_number": 11,
      "question_text": "Quel SerDe est utilis√© par d√©faut pour le format TEXTFILE ?",
      "options": [
        {
          "letter": "A",
          "text": "OpenCSVSerde",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "RegexSerDe",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "LazySimpleSerDe",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "JsonSerDe",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "LazySimpleSerDe = SerDe par d√©faut. \"Lazy\" car les champs sont d√©s√©rialis√©s uniquement √† l'acc√®s (optimisation)."
    },
    {
      "question_number": 12,
      "question_text": "Quel est le s√©parateur de colonnes par d√©faut avec LazySimpleSerDe ?",
      "options": [
        {
          "letter": "A",
          "text": "Virgule (,)",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Point-virgule (;)",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "Tabulation (\\t)",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "Espace",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "D√©faut : colonnes s√©par√©es par TAB, lignes par \\n, NULL repr√©sent√© par \\N. Modifiable via `ROW FORMAT DELIMITED`."
    },
    {
      "question_number": 13,
      "question_text": "Comment sont repr√©sent√©es les valeurs NULL par d√©faut dans Hive ?",
      "options": [
        {
          "letter": "A",
          "text": "NULL",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "empty",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "\\N",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "(null)",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "\\N = repr√©sentation par d√©faut de NULL. Modifiable via `TBLPROPERTIES('serialization.null.format'='')` pour cha√Æne vide."
    },
    {
      "question_number": 14,
      "question_text": "Quel SerDe utiliser pour parser des fichiers logs avec des expressions r√©guli√®res ?",
      "options": [
        {
          "letter": "A",
          "text": "OpenCSVSerde",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "RegexSerDe",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "LogSerDe",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "PatternSerDe",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe' WITH SERDEPROPERTIES (\"input.regex\" = \"...\")`. Puissant pour les logs Apache, etc."
    },
    {
      "question_number": 15,
      "question_text": "Quelle propri√©t√© permet d'ignorer la ligne d'en-t√™te d'un fichier CSV ?",
      "options": [
        {
          "letter": "A",
          "text": "ignore.header=true",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "skip.header.line.count",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "header.skip.count",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "no.header",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`TBLPROPERTIES('skip.header.line.count'='1')` ignore la premi√®re ligne. Essentiel pour les CSV avec en-t√™tes de colonnes."
    },
    {
      "question_number": 16,
      "question_text": "Quelle commande permet de voir la structure d√©taill√©e d'une table ?",
      "options": [
        {
          "letter": "A",
          "text": "SHOW TABLE table_name",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "DESCRIBE FORMATTED table_name",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "VIEW STRUCTURE table_name",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "TABLE INFO table_name",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`DESCRIBE FORMATTED` montre tout : colonnes, types, partitions, SerDe, location HDFS, propri√©t√©s. Plus complet que `DESCRIBE` simple."
    },
    {
      "question_number": 17,
      "question_text": "Le mot-cl√© LOCAL dans LOAD DATA indique que le fichier se trouve :",
      "options": [
        {
          "letter": "A",
          "text": "Dans HDFS",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Dans le syst√®me de fichiers local",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Sur un serveur distant",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Dans le Metastore",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`LOAD DATA LOCAL INPATH '/home/user/file.csv'` = fichier local. Sans LOCAL = fichier d√©j√† dans HDFS."
    },
    {
      "question_number": 18,
      "question_text": "Que fait LOAD DATA INPATH (sans LOCAL) ?",
      "options": [
        {
          "letter": "A",
          "text": "Copie le fichier local vers HDFS",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "D√©place le fichier HDFS vers la table",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Cr√©e un lien symbolique",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Compresse le fichier",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Sans LOCAL : le fichier HDFS est d√©plac√© (pas copi√©) vers le r√©pertoire de la table. Avec LOCAL : le fichier est copi√© de local vers HDFS."
    },
    {
      "question_number": 19,
      "question_text": "Quelle option permet de remplacer les donn√©es existantes lors du chargement ?",
      "options": [
        {
          "letter": "A",
          "text": "REPLACE",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "OVERWRITE",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "UPDATE",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "REFRESH",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`LOAD DATA ... OVERWRITE INTO TABLE` efface d'abord le contenu. Sans OVERWRITE, les nouvelles donn√©es sont ajout√©es aux existantes."
    },
    {
      "question_number": 20,
      "question_text": "Pour convertir un fichier texte en Parquet, quelle est la m√©thode recommand√©e ?",
      "options": [
        {
          "letter": "A",
          "text": "Utiliser une commande de conversion directe",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Cr√©er une table temporaire texte puis INSERT INTO une table Parquet",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Renommer le fichier",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Modifier le format dans le Metastore",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "1) CREATE TEMPORARY TABLE tmp STORED AS TEXTFILE, 2) LOAD DATA, 3) CREATE TABLE final STORED AS PARQUET, 4) INSERT INTO final SELECT * FROM tmp."
    },
    {
      "question_number": 21,
      "question_text": "Quelle commande permet d'activer le partitionnement dynamique non strict ?",
      "options": [
        {
          "letter": "A",
          "text": "SET hive.partition.dynamic=true",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "SET hive.exec.dynamic.partition.mode=nonstrict",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "SET hive.dynamic.mode=all",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "SET partition.mode=dynamic",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Mode strict (d√©faut) : au moins une partition statique requise. Mode nonstrict : toutes les partitions peuvent √™tre dynamiques."
    },
    {
      "question_number": 22,
      "question_text": "Dans une insertion avec partition dynamique, o√π doit se trouver la colonne de partition dans le SELECT ?",
      "options": [
        {
          "letter": "A",
          "text": "En premi√®re position",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "En derni√®re position",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "N'importe o√π",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Elle ne doit pas √™tre dans le SELECT",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`INSERT INTO table PARTITION(year, month) SELECT col1, col2, year, month FROM src`. Les colonnes de partition sont √† la fin du SELECT."
    },
    {
      "question_number": 23,
      "question_text": "Quelle commande ajoute manuellement une partition √† une table ?",
      "options": [
        {
          "letter": "A",
          "text": "CREATE PARTITION",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "ADD PARTITION",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "ALTER TABLE ... ADD PARTITION",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "INSERT PARTITION",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`ALTER TABLE t ADD PARTITION (year=2024, month=1)`. Cr√©e le r√©pertoire et enregistre la partition dans le Metastore."
    },
    {
      "question_number": 24,
      "question_text": "Que fait la commande SET hive.enforce.bucketing=true ?",
      "options": [
        {
          "letter": "A",
          "text": "Active le partitionnement",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Force le respect du bucketing lors des insertions",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "D√©sactive le bucketing",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Cr√©e des buckets automatiquement",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Avec `enforce.bucketing=true`, Hive garantit que les donn√©es sont correctement distribu√©es dans les buckets lors de l'insertion."
    },
    {
      "question_number": 25,
      "question_text": "Pourquoi le bucketing optimise-t-il les jointures ?",
      "options": [
        {
          "letter": "A",
          "text": "Il compresse les donn√©es",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Les donn√©es avec m√™me cl√© sont dans le m√™me bucket, √©vitant le shuffle",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Il trie les donn√©es",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Il r√©duit la taille des tables",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "M√™me cl√© = m√™me hash = m√™me bucket. Jointure : bucket 0 de A avec bucket 0 de B, etc. Pas besoin de redistribuer les donn√©es sur le r√©seau (shuffle)."
    },
    {
      "question_number": 26,
      "question_text": "Pour optimiser une jointure entre deux tables bucket√©es, elles doivent avoir :",
      "options": [
        {
          "letter": "A",
          "text": "Le m√™me nom",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "La m√™me cl√© de bucket et le m√™me nombre de buckets",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Le m√™me format de stockage",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Les m√™mes colonnes",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "M√™me cl√© + m√™me nombre de buckets = jointure optimis√©e (bucket-map join). Sinon, shuffle n√©cessaire."
    },
    {
      "question_number": 27,
      "question_text": "Quelle clause d√©finit le d√©limiteur de champs dans un fichier ?",
      "options": [
        {
          "letter": "A",
          "text": "FIELDS DELIMITED BY",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "FIELDS TERMINATED BY",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "COLUMN SEPARATOR",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "FIELD DELIMITER",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`ROW FORMAT DELIMITED FIELDS TERMINATED BY ','`. Syntaxe standard pour les fichiers CSV ou d√©limit√©s."
    },
    {
      "question_number": 28,
      "question_text": "Quelle clause d√©finit le d√©limiteur de lignes ?",
      "options": [
        {
          "letter": "A",
          "text": "ROWS TERMINATED BY",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "LINES TERMINATED BY",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "LINE SEPARATOR",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "ROW DELIMITER",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`LINES TERMINATED BY '\\n'` (d√©faut). Rarement modifi√© sauf pour des formats sp√©ciaux."
    },
    {
      "question_number": 29,
      "question_text": "Le SerDe OpenCSVSerde est recommand√© pour quel type de fichiers ?",
      "options": [
        {
          "letter": "A",
          "text": "JSON",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "CSV avec guillemets et √©chappements",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Fichiers binaires",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Fichiers XML",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "OpenCSVSerde g√®re correctement les guillemets (\"valeur, avec virgule\"), les √©chappements, etc. Meilleur que LazySimpleSerDe pour les vrais CSV."
    },
    {
      "question_number": 30,
      "question_text": "Quel format de stockage offre la meilleure compression selon le cours ?",
      "options": [
        {
          "letter": "A",
          "text": "TEXTFILE",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "PARQUET",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "ORC",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "AVRO",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "ORC offre g√©n√©ralement la meilleure compression (optimis√© pour Hive). PARQUET est plus portable (Spark, Impala). Les deux sont bien meilleurs que TEXTFILE."
    },
    {
      "question_number": 31,
      "question_text": "Quelle commande INSERT ajoute des donn√©es sans supprimer les existantes ?",
      "options": [
        {
          "letter": "A",
          "text": "INSERT OVERWRITE",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "INSERT INTO",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "INSERT APPEND",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "INSERT ADD",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`INSERT INTO TABLE t SELECT ...` ajoute aux donn√©es existantes. `INSERT OVERWRITE` remplace tout."
    },
    {
      "question_number": 32,
      "question_text": "Quelle commande INSERT remplace les donn√©es existantes ?",
      "options": [
        {
          "letter": "A",
          "text": "INSERT INTO",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "INSERT OVERWRITE",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "INSERT REPLACE",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "INSERT UPDATE",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`INSERT OVERWRITE TABLE t SELECT ...` supprime les donn√©es actuelles avant d'ins√©rer. Utile pour les rechargements complets."
    },
    {
      "question_number": 33,
      "question_text": "Dans CREATE TABLE AS SELECT, peut-on cr√©er une table externe ?",
      "options": [
        {
          "letter": "A",
          "text": "Oui, avec EXTERNAL",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Non, uniquement des tables internes",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Seulement avec LOCATION",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Seulement pour les tables partitionn√©es",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "CTAS cr√©e toujours une table interne. Pour une table externe, cr√©ez d'abord la structure avec CREATE EXTERNAL TABLE puis INSERT INTO."
    },
    {
      "question_number": 34,
      "question_text": "Quelle est la syntaxe pour ins√©rer plusieurs valeurs en une commande ?",
      "options": [
        {
          "letter": "A",
          "text": "INSERT INTO TABLE t VALUES (v1), (v2), (v3)",
          "is_correct": true
        },
        {
          "letter": "B",
          "text": "INSERT INTO TABLE t VALUES (v1); VALUES (v2)",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "INSERT MULTI INTO TABLE t",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "BULK INSERT INTO TABLE t",
          "is_correct": false
        }
      ],
      "correct_answer": "A",
      "conseil": "`INSERT INTO TABLE t VALUES (1,'a'), (2,'b'), (3,'c')`. Chaque tuple entre parenth√®ses, s√©par√©s par des virgules."
    },
    {
      "question_number": 35,
      "question_text": "Quel est l'avantage des tables TEMPORARY ?",
      "options": [
        {
          "letter": "A",
          "text": "Elles sont plus rapides",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Elles sont visibles uniquement dans la session courante",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "Elles sont compress√©es automatiquement",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Elles sont r√©pliqu√©es",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Tables TEMPORARY = disparaissent √† la fin de la session. Parfait pour les tables interm√©diaires de transformation sans polluer le sch√©ma."
    },
    {
      "question_number": 36,
      "question_text": "Quelle commande permet de modifier les propri√©t√©s d'une table existante ?",
      "options": [
        {
          "letter": "A",
          "text": "MODIFY TABLE",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "UPDATE TABLE",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "ALTER TABLE",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "CHANGE TABLE",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`ALTER TABLE` pour : renommer, ajouter colonnes, modifier propri√©t√©s, ajouter partitions. Commande tr√®s polyvalente."
    },
    {
      "question_number": 37,
      "question_text": "Comment ajouter un commentaire √† une colonne lors de la cr√©ation de table ?",
      "options": [
        {
          "letter": "A",
          "text": "-- commentaire",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "/* commentaire */",
          "is_correct": false
        },
        {
          "letter": "C",
          "text": "COMMENT 'description'",
          "is_correct": true
        },
        {
          "letter": "D",
          "text": "DESC 'description'",
          "is_correct": false
        }
      ],
      "correct_answer": "C",
      "conseil": "`col_name TYPE COMMENT 'description'`. Les commentaires sont stock√©s dans le Metastore et visibles avec DESCRIBE."
    },
    {
      "question_number": 38,
      "question_text": "Quelle clause permet de d√©finir la propri√©t√© de format null personnalis√© ?",
      "options": [
        {
          "letter": "A",
          "text": "NULLFORMAT",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "TBLPROPERTIES('serialization.null.format'='...')",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "NULL AS",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "NULLVALUE",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`TBLPROPERTIES('serialization.null.format'='')` pour repr√©senter NULL par une cha√Æne vide au lieu de \\N."
    },
    {
      "question_number": 39,
      "question_text": "Quel SerDe est automatiquement utilis√© pour le format ORC ?",
      "options": [
        {
          "letter": "A",
          "text": "LazySimpleSerDe",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "OrcSerde",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "BinarySerDe",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "ColumnSerDe",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "`STORED AS ORC` implique automatiquement OrcSerde. De m√™me : PARQUET ‚Üí ParquetHiveSerDe, AVRO ‚Üí AvroSerDe."
    },
    {
      "question_number": 40,
      "question_text": "Que signifie \"Lazy reading\" dans le contexte du SerDe par d√©faut ?",
      "options": [
        {
          "letter": "A",
          "text": "La lecture est lente",
          "is_correct": false
        },
        {
          "letter": "B",
          "text": "Les champs sont convertis uniquement lorsqu'ils sont utilis√©s",
          "is_correct": true
        },
        {
          "letter": "C",
          "text": "La lecture est diff√©r√©e",
          "is_correct": false
        },
        {
          "letter": "D",
          "text": "Les donn√©es sont charg√©es en m√©moire",
          "is_correct": false
        }
      ],
      "correct_answer": "B",
      "conseil": "Lazy = paresseux. Les colonnes sont d√©s√©rialis√©es √† la demande. Si une requ√™te n'utilise que 2 colonnes sur 10, les 8 autres ne sont pas trait√©es. ## üìä R√©sum√© des Th√®mes Abord√©s | Th√®me | Nombre de Questions | |-------|---------------------| | Gestion des bases de donn√©es | 5 | | Cr√©ation de tables (syntaxe, options) | 8 | | SerDe et formats de stockage | 8 | | Chargement de donn√©es (LOAD, INSERT) | 8 | | Partitionnement et Bucketing | 6 | | Commandes utilitaires | 5 | ## Conseils pour l'Examen 1. Ma√Ætrisez la syntaxe de base : ```sql CREATE DATABASE IF NOT EXISTS db; USE db; SHOW TABLES; DESCRIBE FORMATTED table; ``` 2. Connaissez les diff√©rences cl√©s : - LOCAL vs non-LOCAL dans LOAD DATA - INTO vs OVERWRITE - Table INTERNE vs EXTERNE - Partition STATIQUE vs DYNAMIQUE 3. Retenez les SerDe courants : - LazySimpleSerDe (d√©faut TEXTFILE) - OpenCSVSerde (CSV propres) - RegexSerDe (logs) - OrcSerde, ParquetHiveSerDe (automatiques) 4. Comprenez le bucketing : - M√™me cl√© + m√™me nombre de buckets = jointure optimis√©e - `SET hive.enforce.bucketing=true` 5. N'oubliez pas les propri√©t√©s importantes : - `skip.header.line.count` - `serialization.null.format` - `hive.exec.dynamic.partition.mode` Bonne chance pour votre examen ! üçÄ"
    }
  ]
}